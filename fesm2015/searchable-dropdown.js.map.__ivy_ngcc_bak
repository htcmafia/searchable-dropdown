{"version":3,"file":"searchable-dropdown.js","sources":["../../../projects/searchable-dropdown/src/lib/searchable-dropdown.service.ts","../../../projects/searchable-dropdown/src/lib/searchable-dropdown.component.ts","../../../projects/searchable-dropdown/src/lib/searchable-dropdown.module.ts","../../../projects/searchable-dropdown/src/public-api.ts","../../../projects/searchable-dropdown/src/searchable-dropdown.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class SearchableDropdownService {\n\n  constructor() { }\n}\n","import { Component, EventEmitter, HostListener, Input, OnInit, Output } from '@angular/core';\n\n@Component({\n  selector: 'app-searchable-dropdown',\n  templateUrl: './searchable-dropdown.component.html',\n  styleUrls: ['./searchable-dropdown.component.scss']\n})\nexport class SearchableDropdownComponent implements OnInit {\n\n  @Output() onStart = new EventEmitter<SearchableDropdownComponent>();\n  @Output() onOpen = new EventEmitter<void>();\n\n  //Returns\n  @Input() key: number;\n  @Output() keyChange = new EventEmitter<number>();\n\n  @Input() value: string;\n  @Output() valueChange = new EventEmitter<string>();\n\n  //Placeholder\n  @Input() placeHolder: string = \"\";\n\n  //Calls on keyup\n  @Output() onSearch = new EventEmitter<string>();\n\n  @Input() defaultItem: { key, value };\n\n  itemsToShow: { key, value }[] = [];\n\n  //is item list visible\n  showItemList: boolean = false;\n  //is loading On/Off\n  isListLoading: boolean = false;\n\n  //Delay between the value entered in textfield and\n  //event emitter emittion.\n  private searchListTimeOut;\n\n  //Open/Close add new item screen\n  addNewItem: boolean = false;\n\n  private isItemSelected: boolean = false;\n  private isFocusInsideComponent = false;\n  private isComponentClicked = false;\n\n  constructor() { }\n\n  ngOnInit() {\n    if (this.defaultItem)\n      this.addItem(this.defaultItem.key, this.defaultItem.value);\n\n    this.onStart.emit(this);\n  }\n\n  //When item is selected from the list.\n  onItemClick(index: number) {\n    this.value = this.itemsToShow[index].value;\n    this.key = this.itemsToShow[index].key;\n    this.value = this.itemsToShow[index].value;\n    this.keyChange.emit(this.key);\n    this.valueChange.emit(this.value);\n    this.isItemSelected = true;\n  }\n\n  searchList() {\n    if (this.searchListTimeOut)\n      clearTimeout(this.searchListTimeOut);\n\n    this.searchListTimeOut = setTimeout(() => {\n      this.onSearch.emit(this.value);\n    }, 500);\n  }\n\n  //Manually add an item to the list.\n  addItem(key: number, value: string) {\n    this.itemsToShow.push({ key: key, value: value });\n    this.value = value;\n    this.key = key;\n    this.keyChange.emit(this.key);\n  }\n\n  //open/close add new item screne.\n  showAddNewItemSection(): void {\n    this.addNewItem = !this.addNewItem;\n  }\n\n  //if item list is in view hide it,\n  //if item list is hidden bring it in view.\n  @HostListener('click')\n  private clickInside(): void {\n\n    if (!this.showItemList) {\n      this.onOpen.emit(null);\n    }\n\n    this.showItemList = true;\n    this.isFocusInsideComponent = true;\n    this.isComponentClicked = true;\n    if (this.isItemSelected) {\n      this.isItemSelected = false;\n      //Force system to think the click was made outside.\n      this.isFocusInsideComponent = false;\n      this.clickout();\n    }\n  }\n\n  //Close when click outside the component\n  @HostListener('document:click')\n  private clickout(): void {\n    if (!this.isFocusInsideComponent && this.isComponentClicked) {\n\n      this.showItemList = false;\n      // do the heavy process\n      this.isComponentClicked = false;\n\n      let valueFound: boolean = false;\n      let currentItem: string;\n      this.itemsToShow.filter(item => {\n        if (this.value != null) {\n          currentItem = item.value;\n          if (currentItem.toString().toLowerCase() == this.value.toString().toLowerCase()) {\n            this.value = item.value;\n            this.key = item.key;\n            this.value = item.value;\n            this.keyChange.emit(this.key);\n            this.valueChange.emit(this.value);\n            valueFound = true;\n            return;\n          }\n        }\n      });\n      if (!valueFound) {\n        this.value = \"\";\n      }\n    }\n    this.isFocusInsideComponent = false;\n  }\n\n\n  //Close on Enter key\n  @HostListener('window:keyup.enter', ['$event'])\n  private handleKeyboardEvent(event: KeyboardEvent) {\n    this.showItemList = false;\n    // do the heavy process\n    this.isComponentClicked = false;\n  }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { FormsModule } from '@angular/forms';\nimport { SearchableDropdownComponent } from './searchable-dropdown.component';\n\n\n\n@NgModule({\n  declarations: [SearchableDropdownComponent],\n  imports: [\n    CommonModule,\n    FormsModule,\n  ],\n  exports: [\n    SearchableDropdownComponent,\n    CommonModule,\n    FormsModule,\n  ]\n})\nexport class SearchableDropdownModule { }\n","/*\n * Public API Surface of searchable-dropdown\n */\n\nexport * from './lib/searchable-dropdown.service';\nexport * from './lib/searchable-dropdown.component';\nexport * from './lib/searchable-dropdown.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":[],"mappings":";;;;MAKa,yBAAyB;IAEpC,iBAAiB;;;;YALlB,UAAU,SAAC;gBACV,UAAU,EAAE,MAAM;aACnB;;;;MCGY,2BAA2B;IAsCtC;QApCU,YAAO,GAAG,IAAI,YAAY,EAA+B,CAAC;QAC1D,WAAM,GAAG,IAAI,YAAY,EAAQ,CAAC;QAIlC,cAAS,GAAG,IAAI,YAAY,EAAU,CAAC;QAGvC,gBAAW,GAAG,IAAI,YAAY,EAAU,CAAC;;QAG1C,gBAAW,GAAW,EAAE,CAAC;;QAGxB,aAAQ,GAAG,IAAI,YAAY,EAAU,CAAC;QAIhD,gBAAW,GAAqB,EAAE,CAAC;;QAGnC,iBAAY,GAAY,KAAK,CAAC;;QAE9B,kBAAa,GAAY,KAAK,CAAC;;QAO/B,eAAU,GAAY,KAAK,CAAC;QAEpB,mBAAc,GAAY,KAAK,CAAC;QAChC,2BAAsB,GAAG,KAAK,CAAC;QAC/B,uBAAkB,GAAG,KAAK,CAAC;KAElB;IAEjB,QAAQ;QACN,IAAI,IAAI,CAAC,WAAW;YAClB,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,GAAG,EAAE,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QAE7D,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KACzB;;IAGD,WAAW,CAAC,KAAa;QACvB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC;QAC3C,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,GAAG,CAAC;QACvC,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC,KAAK,CAAC;QAC3C,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAC9B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QAClC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;KAC5B;IAED,UAAU;QACR,IAAI,IAAI,CAAC,iBAAiB;YACxB,YAAY,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC;QAEvC,IAAI,CAAC,iBAAiB,GAAG,UAAU,CAAC;YAClC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAChC,EAAE,GAAG,CAAC,CAAC;KACT;;IAGD,OAAO,CAAC,GAAW,EAAE,KAAa;QAChC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,KAAK,EAAE,KAAK,EAAE,CAAC,CAAC;QAClD,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;QACnB,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;QACf,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;KAC/B;;IAGD,qBAAqB;QACnB,IAAI,CAAC,UAAU,GAAG,CAAC,IAAI,CAAC,UAAU,CAAC;KACpC;;;IAKO,WAAW;QAEjB,IAAI,CAAC,IAAI,CAAC,YAAY,EAAE;YACtB,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;SACxB;QAED,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC;QACzB,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC;QACnC,IAAI,CAAC,kBAAkB,GAAG,IAAI,CAAC;QAC/B,IAAI,IAAI,CAAC,cAAc,EAAE;YACvB,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;;YAE5B,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;YACpC,IAAI,CAAC,QAAQ,EAAE,CAAC;SACjB;KACF;;IAIO,QAAQ;QACd,IAAI,CAAC,IAAI,CAAC,sBAAsB,IAAI,IAAI,CAAC,kBAAkB,EAAE;YAE3D,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;;YAE1B,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC;YAEhC,IAAI,UAAU,GAAY,KAAK,CAAC;YAChC,IAAI,WAAmB,CAAC;YACxB,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI;gBAC1B,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,EAAE;oBACtB,WAAW,GAAG,IAAI,CAAC,KAAK,CAAC;oBACzB,IAAI,WAAW,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,IAAI,IAAI,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,WAAW,EAAE,EAAE;wBAC/E,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;wBACxB,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,GAAG,CAAC;wBACpB,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;wBACxB,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;wBAC9B,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;wBAClC,UAAU,GAAG,IAAI,CAAC;wBAClB,OAAO;qBACR;iBACF;aACF,CAAC,CAAC;YACH,IAAI,CAAC,UAAU,EAAE;gBACf,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;aACjB;SACF;QACD,IAAI,CAAC,sBAAsB,GAAG,KAAK,CAAC;KACrC;;IAKO,mBAAmB,CAAC,KAAoB;QAC9C,IAAI,CAAC,YAAY,GAAG,KAAK,CAAC;;QAE1B,IAAI,CAAC,kBAAkB,GAAG,KAAK,CAAC;KACjC;;;YA/IF,SAAS,SAAC;gBACT,QAAQ,EAAE,yBAAyB;gBACnC,6kCAAmD;;aAEpD;;;;sBAGE,MAAM;qBACN,MAAM;kBAGN,KAAK;wBACL,MAAM;oBAEN,KAAK;0BACL,MAAM;0BAGN,KAAK;uBAGL,MAAM;0BAEN,KAAK;0BA+DL,YAAY,SAAC,OAAO;uBAmBpB,YAAY,SAAC,gBAAgB;kCAiC7B,YAAY,SAAC,oBAAoB,EAAE,CAAC,QAAQ,CAAC;;;MCzHnC,wBAAwB;;;YAZpC,QAAQ,SAAC;gBACR,YAAY,EAAE,CAAC,2BAA2B,CAAC;gBAC3C,OAAO,EAAE;oBACP,YAAY;oBACZ,WAAW;iBACZ;gBACD,OAAO,EAAE;oBACP,2BAA2B;oBAC3B,YAAY;oBACZ,WAAW;iBACZ;aACF;;;AClBD;;;;ACAA;;;;;;"}